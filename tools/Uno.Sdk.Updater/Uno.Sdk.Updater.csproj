<Project Sdk="Microsoft.NET.Sdk">

	<PropertyGroup>
		<OutputType>Exe</OutputType>
		<TargetFramework>net8.0</TargetFramework>
		<ImplicitUsings>enable</ImplicitUsings>
		<Nullable>enable</Nullable>
		<TemplatesSourceDirectory>$([MSBuild]::NormalizePath('$(MSBuildThisFileDirectory)', '..', '..', 'src'))</TemplatesSourceDirectory>
		<UnoSdkDirectory>$([MSBuild]::NormalizePath('$(TemplatesSourceDirectory)', 'Uno.Sdk'))</UnoSdkDirectory>
		<UnoSdkUpdaterDirectory>$(MSBuildThisFileDirectory)</UnoSdkUpdaterDirectory>
	</PropertyGroup>

	<ItemGroup>
		<None Update="ReadMe.md" CopyToOutputDirectory="PreserveNewest" />
	</ItemGroup>

	<ItemGroup>
		<PackageReference Include="NuGet.Packaging" Version="6.10.0" />
	</ItemGroup>

	<Target Name="GenerateVersion" BeforeTargets="BeforeCompile">

		<PropertyGroup Condition="'$(Configuration)'=='Debug'">
			<!-- When debugging, change this version to the next pre-release -->
			<NBGV_SemVer2 Condition="'$(NBGV_SemVer2)'==''">255.255.255.255</NBGV_SemVer2>
		</PropertyGroup>

		<Error Condition="'$(NBGV_SemVer2)'==''"
			   Text="The environment variable NBGV_SemVer2 must be set" />

		<ItemGroup>
			<_GitVersionFileSystem Include="$(IntermediateOutputPath)\GitVersionInformation.g.cs" />
			<_GitVersionFileSystemLine Include="//------------------------------------------------------------------------------" />
			<_GitVersionFileSystemLine Include="// &lt;auto-generated&gt;" />
			<_GitVersionFileSystemLine Include="//     This code was auto generated by the build. Changes to this file will be lost." />
			<_GitVersionFileSystemLine Include="// &lt;/auto-generated&gt;" />
			<_GitVersionFileSystemLine Include="//------------------------------------------------------------------------------" />
			<_GitVersionFileSystemLine Include="using Uno.Sdk.Models%3b" />
			<_GitVersionFileSystemLine Include="namespace Uno.Sdk.Updater%3b" />
			<_GitVersionFileSystemLine Include="[global::System.Runtime.CompilerServices.CompilerGenerated]" />
			<_GitVersionFileSystemLine Include="[global::System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverage]" />
			<_GitVersionFileSystemLine Include="internal static partial class GitVersionInformation" />
			<_GitVersionFileSystemLine Include="{" />
			<_GitVersionFileSystemLine Include="public const string NuGetVersion = @&quot;$(NBGV_SemVer2)&quot;%3b" />
			<_GitVersionFileSystemLine Include="}" />
		</ItemGroup>
		<WriteLinesToFile File="%(_GitVersionFileSystem.Identity)"
						  Lines="@(_GitVersionFileSystemLine)"
						  Overwrite="true" />

		<ItemGroup>
			<Compile Include="%(_GitVersionFileSystem.Identity)" />
			<_GeneratedCodeFiles Include="%(_GitVersionFileSystem.Identity)" />
			<FileWrites Include="%(_GitVersionFileSystem.Identity)" />
		</ItemGroup>
	</Target>

	<Target Name="GenerateLocalFileSystem" BeforeTargets="BeforeCompile">
		<PropertyGroup>
			<TemplateVersion Condition=" $(TemplateVersion) == '' ">$(Version)</TemplateVersion>
		</PropertyGroup>
		<ItemGroup>
			<_LocalFileSystem Include="$(IntermediateOutputPath)\LocalFileSystem.cs" />
			<_FileSystemLine Include="//------------------------------------------------------------------------------" />
			<_FileSystemLine Include="// &lt;auto-generated&gt;" />
			<_FileSystemLine Include="//     This code was auto generated by the build. Changes to this file will be lost." />
			<_FileSystemLine Include="// &lt;/auto-generated&gt;" />
			<_FileSystemLine Include="//------------------------------------------------------------------------------" />
			<_FileSystemLine Include="using Uno.Sdk.Models%3b" />
			<_FileSystemLine Include="namespace Uno.Sdk.Updater%3b" />
			<_FileSystemLine Include="[global::System.Runtime.CompilerServices.CompilerGenerated]" />
			<_FileSystemLine Include="[global::System.Diagnostics.CodeAnalysis.ExcludeFromCodeCoverage]" />
			<_FileSystemLine Include="internal static partial class LocalFileSystem" />
			<_FileSystemLine Include="{" />
			<_FileSystemLine Include="public const string TemplatesSourceDirectory = @&quot;$(TemplatesSourceDirectory)&quot;%3b" />
			<_FileSystemLine Include="public const string UnoSdkDirectory = @&quot;$(UnoSdkDirectory)&quot;%3b" />
			<_FileSystemLine Include="public const string UnoSdkUpdaterDirectory = @&quot;$(UnoSdkUpdaterDirectory)&quot;%3b" />
			<_FileSystemLine Include="}" />
		</ItemGroup>
		<WriteLinesToFile File="%(_LocalFileSystem.Identity)"
						  Lines="@(_FileSystemLine)"
						  Overwrite="true" />

		<ItemGroup>
			<Compile Include="%(_LocalFileSystem.Identity)" />
			<_GeneratedCodeFiles Include="%(_LocalFileSystem.Identity)" />
			<FileWrites Include="%(_LocalFileSystem.Identity)" />
		</ItemGroup>
	</Target>

</Project>

